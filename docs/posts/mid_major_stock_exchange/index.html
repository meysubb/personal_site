<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.247">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Meyappan Subbaiah">
<meta name="dcterms.date" content="2018-11-11">
<meta name="description" content="Investing in CBB mid-major teams">

<title>Meyappan Subbaiah - Mid-Major Stock Exchange</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-90700102-1', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Meyappan Subbaiah</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">Meyappan</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Posts</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/meysubb"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/msubbaiah1"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Mid-Major Stock Exchange</h1>
                  <div>
        <div class="description">
          Investing in CBB mid-major teams
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">college basketball</div>
                <div class="quarto-category">R</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Meyappan Subbaiah </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 11, 2018</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#team-ranking-cost-correlations" id="toc-team-ranking-cost-correlations" class="nav-link active" data-scroll-target="#team-ranking-cost-correlations">Team Ranking-Cost Correlations</a></li>
  <li><a href="#estimating-future-costs" id="toc-estimating-future-costs" class="nav-link" data-scroll-target="#estimating-future-costs">Estimating Future Costs</a></li>
  <li><a href="#linearinteger-programming" id="toc-linearinteger-programming" class="nav-link" data-scroll-target="#linearinteger-programming">Linear/Integer Programming</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>With the start of CBB season last week, the SB Nation blog covering Mid-Majors (Mid-Major Madness) introduced a new fantasy game, <a href="https://www.midmajormadness.com/2018/11/6/18068346/welcome-to-the-mid-major-madness-stock-exchange-college-basketball-stock-game">Mid-Major Stock Exchange</a>. The premise, similar to the stock market, is to create a portfolio with $500.</p>
<p>I’ll be honest, I don’t watch a lot of mid-major basketball. Mostly just nationally televised games and the Aggies. This seemed like a prime chance to flex Linear and Integer Programming. Linear and Integer Programming is used in many industries to focus on resource allocation, the goal is to find optimal solutions.</p>
<p>In my case, I wanted to optimize returns on mid-major teams. Here is where I encountered the first problem, this is the pre-season and we have not had any games (or previous history in this game) to identify returns. However, if I can correlate team rankings (created from analytics methods) with the cost set it’s possible to estimate potential returns.</p>
<section id="team-ranking-cost-correlations" class="level3">
<h3 class="anchored" data-anchor-id="team-ranking-cost-correlations">Team Ranking-Cost Correlations</h3>
<p>If anyone’s interested, I’d definitely look at <span class="citation" data-cites="brian">@brian</span>_lefevre1 work. I used a variation of his pre-season ranking system. First let’s take a look at how the rankings compare to the cost set.</p>
<p><img src="cost_cor.png" class="img-fluid"></p>
<p>The rankings and the cost are similar enough, that I’m confident with using the standard errors of the team rankings as part of a random walk to estimate the cost in the future. The team rankings are derived from a linear regression, estimating the adjusted efficiency margins.</p>
</section>
<section id="estimating-future-costs" class="level3">
<h3 class="anchored" data-anchor-id="estimating-future-costs">Estimating Future Costs</h3>
<p>Random Walk forecasting looks something like this:</p>
<p><span class="math display">\[\begin{align*}
y\_{1} = y\_{0} + e\_t \\
y_{1} = y_{0} + e_t
\end{align*}\]</span></p>
<p>In our case, cost will be estimated as follows</p>
<p><span class="math display">\[\begin{align*}
C_{1} = C_{0} (1+\mathcal{N}(\mu,\sigma)) \\
C_{2} = C_{1} (1+\mathcal{N}(\mu,\sigma))
\end{align*}\]</span></p>
<p>The <code>rowwise</code> function in <code>dplyr</code> is key here, otherwise we would use the same random number to estimate future costs for these teams. Later when determining the returns, the differences would all be the same.</p>
<p>There are a few teams that have just joined the D-1 ranks or for some reason data is missing. For this, I imputed values based on similar teams. Similarity was defined by teams who had a similar cost (within a 5% margin). The code for this can be seen below.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>ecdf_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(x,perc) <span class="fu">ecdf</span>(x)(perc)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>impute_values <span class="ot">&lt;-</span> <span class="cf">function</span>(df){</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  inds <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">is.na</span>(df<span class="sc">$</span>predTeamRk))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(val <span class="cf">in</span> inds){</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    cost_search <span class="ot">&lt;-</span> df[val,<span class="st">'Cost'</span>] <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    percent_val <span class="ot">&lt;-</span> <span class="fu">ecdf_fun</span>(<span class="fu">sort</span>(df<span class="sc">$</span>Cost),cost_search)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    top_pct <span class="ot">&lt;-</span> percent_val <span class="sc">+</span> <span class="fl">0.05</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    low_pct <span class="ot">&lt;-</span> percent_val <span class="sc">-</span> <span class="fl">0.05</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    range_val <span class="ot">&lt;-</span> <span class="fu">quantile</span>(df<span class="sc">$</span>Cost, <span class="at">probs =</span> <span class="fu">c</span>(low_pct, top_pct))</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    search_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Cost <span class="sc">&gt;=</span> range_val[<span class="dv">1</span>] <span class="sc">&amp;</span> Cost <span class="sc">&lt;=</span> range_val[<span class="dv">2</span>]) <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>()</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    median_val <span class="ot">&lt;-</span> <span class="fu">median</span>(search_df<span class="sc">$</span>predTeamRk)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    df[val,<span class="st">"predTeamRk"</span>] <span class="ot">&lt;-</span> median_val</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>combine_df <span class="ot">&lt;-</span> <span class="fu">impute_values</span>(combine_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">41</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>combine_df <span class="ot">&lt;-</span> combine_df <span class="sc">%&gt;%</span> <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ret =</span> Cost <span class="sc">*</span> (<span class="dv">1</span><span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span>se.val)),</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ret2 =</span> ret <span class="sc">*</span> (<span class="dv">1</span><span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span>se.val)),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ret3 =</span> ret2 <span class="sc">*</span> (<span class="dv">1</span><span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span>se.val)),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ret4 =</span> ret3 <span class="sc">*</span> (<span class="dv">1</span><span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span>se.val)),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">ret5 =</span> ret4 <span class="sc">*</span> (<span class="dv">1</span><span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span>se.val)),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">ret6 =</span> ret5 <span class="sc">*</span> (<span class="dv">1</span><span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span>se.val)),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">ret7 =</span> ret6 <span class="sc">*</span> (<span class="dv">1</span><span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span>se.val)),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">ret8 =</span> ret7 <span class="sc">*</span> (<span class="dv">1</span><span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span>se.val)),</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">ret9 =</span> ret8 <span class="sc">*</span> (<span class="dv">1</span><span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span>se.val))</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now to calculate the returns, we take the difference of the cost matrix.</p>
<pre><code>##      abilene christian air force    akron
## [1,]          17.81000  20.49000 23.08000
## [2,]          17.56942  20.54356 23.47112
## [3,]          17.59705  20.57641 23.09482</code></pre>
<p>Here is a snapshot of the return matrix. The median of the returns matrix is used as the main objective function in the integer program.</p>
<pre><code>##      abilene christian    air force        akron
## [1,]      -0.013508198  0.002614065  0.016946222
## [2,]       0.001572699  0.001598822 -0.016032414
## [3,]      -0.015698671 -0.001535754 -0.008860428</code></pre>
</section>
<section id="linearinteger-programming" class="level3">
<h3 class="anchored" data-anchor-id="linearinteger-programming">Linear/Integer Programming</h3>
<p>Finally to the good stuff. How do I go about allocating which teams to submit in my portfolio. Linear programs focus on maximizing or minimizing an objective function with a set of constraints. It solves for optimal values of the variables such that the objective function is maximized, in this case.</p>
<p>The objective function here is to be maximized based on the estimated median returns found earlier. The first constraint is to ensure that the total of the investments (all stocks purchased) should amass to less than or equal to $500. Another common constraint is ensuring that the values (stocks) are integers.</p>
<p>Additionally, I added in another constraint to ensure that no more than 10 shares were owned of each team. Since the matrix was a tad large, the <code>lpSolveAPI</code> package is much more robust than <code>lpSolve</code>.</p>
<p>Here we set up the IP, and provide the names of all the teams such that the output is much easier to read.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lpSolveAPI)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">length</span>(ret_mat2)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>fund_allocate <span class="ot">&lt;-</span> <span class="fu">make.lp</span>(<span class="dv">0</span>,n)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>yNames <span class="ot">&lt;-</span> <span class="fu">names</span>(ret_mat2)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(fund_allocate) <span class="ot">&lt;-</span> <span class="fu">c</span>(yNames)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="objective" class="level5">
<h5 class="anchored" data-anchor-id="objective">Objective</h5>
<p>Here we set the objective</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.objfn</span>(fund_allocate,<span class="fu">c</span>(<span class="fu">matrix</span>(ret_mat2, <span class="at">ncol=</span><span class="dv">1</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="constraints" class="level5">
<h5 class="anchored" data-anchor-id="constraints">Constraints</h5>
<p>Now come the constraints</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>costs <span class="ot">&lt;-</span> combine_df <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Cost)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">add.constraint</span>(fund_allocate,costs,<span class="st">"&lt;="</span>,<span class="dv">500</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add.constraint</span>(fund_allocate,<span class="dv">1</span>,<span class="st">"&lt;="</span>,<span class="dv">10</span>,<span class="fu">c</span>(i))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lp.control</span>(fund_allocate,<span class="at">sense=</span><span class="st">'max'</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.type</span>(fund_allocate, <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(fund_allocate), <span class="at">type =</span> <span class="st">'integer'</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write.lp</span>(fund_allocate,<span class="st">'funds.lp'</span>,<span class="at">type =</span> <span class="st">'lp'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Not to add a few final touches. Ensuring that the objective function is maximized (we don’t want to minimize our returns…..) and to treat this as an integer program (only whole stocks).</p>
<p>I ended up submitting two portfolios, I made a mistake in my coding, happens to everyone. I accidentally left the problem type set to binary. It was kind of a nice mistake because this allowed me to see what a more diverse portfolio would be if I only invested in each team once.</p>
<p>A final note I wrote the LP to a text file. It’s helpful to go back and check the text file because the linear program is written out in a clean format.</p>
</section>
</section>
<section id="results" class="level3">
<h3 class="anchored" data-anchor-id="results">Results</h3>
<p>Here is the suggestion on who to invest in for my main portfolio.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>status <span class="ot">=</span> <span class="fu">solve</span>(fund_allocate)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">get.objective</span>(fund_allocate))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>[1] 9.554434</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>solution <span class="ot">=</span> <span class="fu">get.variables</span>(fund_allocate)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>names <span class="ot">&lt;-</span> yNames[<span class="fu">which</span>(solution<span class="sc">!=</span><span class="dv">0</span>)]</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>shares <span class="ot">&lt;-</span> solution[<span class="fu">which</span>(solution<span class="sc">!=</span><span class="dv">0</span>)]</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>cost <span class="ot">&lt;-</span> costs[<span class="fu">which</span>(solution<span class="sc">!=</span><span class="dv">0</span>)]</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>cost_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Team=</span>names,<span class="at">Shares=</span>shares,<span class="at">Cost=</span>cost)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>cost_df <span class="ot">&lt;-</span> cost_df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">total_cost =</span> cost<span class="sc">*</span>shares)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>cost_df <span class="sc">%&gt;%</span>  <span class="fu">kable</span>(<span class="at">format=</span><span class="st">"markdown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Team</th>
<th style="text-align: right;">Shares</th>
<th style="text-align: right;">Cost</th>
<th style="text-align: right;">total_cost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">delaware state</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.25</td>
<td style="text-align: right;">11.25</td>
</tr>
<tr class="even">
<td style="text-align: left;">drake</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">19.82</td>
<td style="text-align: right;">59.46</td>
</tr>
<tr class="odd">
<td style="text-align: left;">florida atlantic</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">13.56</td>
<td style="text-align: right;">135.60</td>
</tr>
<tr class="even">
<td style="text-align: left;">nevada</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">48.94</td>
<td style="text-align: right;">293.64</td>
</tr>
</tbody>
</table>
<p>Here is the suggestion on who to invest in for my diverse portfolio.</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Team</th>
<th style="text-align: right;">Shares</th>
<th style="text-align: right;">Cost</th>
<th style="text-align: right;">total_cost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">arkansas pine bluff</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7.07</td>
<td style="text-align: right;">7.07</td>
</tr>
<tr class="even">
<td style="text-align: left;">byu</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">36.14</td>
<td style="text-align: right;">36.14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">delaware state</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.25</td>
<td style="text-align: right;">1.25</td>
</tr>
<tr class="even">
<td style="text-align: left;">drake</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">19.82</td>
<td style="text-align: right;">19.82</td>
</tr>
<tr class="odd">
<td style="text-align: left;">florida atlantic</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">13.56</td>
<td style="text-align: right;">13.56</td>
</tr>
<tr class="even">
<td style="text-align: left;">florida gulf coast</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">21.01</td>
<td style="text-align: right;">21.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">grand canyon</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">25.57</td>
<td style="text-align: right;">25.57</td>
</tr>
<tr class="even">
<td style="text-align: left;">incarnate word</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7.46</td>
<td style="text-align: right;">7.46</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jacksonville</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">15.36</td>
<td style="text-align: right;">15.36</td>
</tr>
<tr class="even">
<td style="text-align: left;">middle tennessee state</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">25.63</td>
<td style="text-align: right;">25.63</td>
</tr>
<tr class="odd">
<td style="text-align: left;">missouri state</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">21.90</td>
<td style="text-align: right;">21.90</td>
</tr>
<tr class="even">
<td style="text-align: left;">murray state</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">27.50</td>
<td style="text-align: right;">27.50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">nevada</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">48.94</td>
<td style="text-align: right;">48.94</td>
</tr>
<tr class="even">
<td style="text-align: left;">north dakota state</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">20.69</td>
<td style="text-align: right;">20.69</td>
</tr>
<tr class="odd">
<td style="text-align: left;">north texas</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">24.50</td>
<td style="text-align: right;">24.50</td>
</tr>
<tr class="even">
<td style="text-align: left;">oral roberts</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">18.79</td>
<td style="text-align: right;">18.79</td>
</tr>
<tr class="odd">
<td style="text-align: left;">prairie view a&amp;m</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">13.65</td>
<td style="text-align: right;">13.65</td>
</tr>
<tr class="even">
<td style="text-align: left;">st peters</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">21.94</td>
<td style="text-align: right;">21.94</td>
</tr>
<tr class="odd">
<td style="text-align: left;">st francis pa</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">24.36</td>
<td style="text-align: right;">24.36</td>
</tr>
<tr class="even">
<td style="text-align: left;">umbc</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">18.91</td>
<td style="text-align: right;">18.91</td>
</tr>
<tr class="odd">
<td style="text-align: left;">usc upstate</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">10.74</td>
<td style="text-align: right;">10.74</td>
</tr>
<tr class="even">
<td style="text-align: left;">texas san antonio</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">24.48</td>
<td style="text-align: right;">24.48</td>
</tr>
<tr class="odd">
<td style="text-align: left;">vcu</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">27.77</td>
<td style="text-align: right;">27.77</td>
</tr>
<tr class="even">
<td style="text-align: left;">wagner</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">21.71</td>
<td style="text-align: right;">21.71</td>
</tr>
</tbody>
</table>
<p>Full code can be found <a href="https://github.com/meysubb/NCAAB_projects/tree/master/Mid-Major-xchange">here</a>.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>